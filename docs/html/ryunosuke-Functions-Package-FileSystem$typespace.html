<!DOCTYPE html>
<html>
<head>	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/foundation.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/typeahead.js-bootstrap-css/1.2.1/typeaheadjs.min.css">
	<link rel="stylesheet" type="text/css" data-href="common.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-3-typeahead/3.1.1/bootstrap3-typeahead.min.js"></script>
	<script data-src="common.js"></script>

	<script>
        (function () {
            var cachekey;
            try {
                cachekey = window.parent.CACHEKEY;
            }
            catch (e) {
                cachekey = 'nocache';
            }
            $('link[data-href]').attr('href', function () {
                return this.dataset.href + '?' + cachekey;
            });
            $('script[data-src]').attr('src', function () {
                return this.dataset.src + '?' + cachekey;
            });

            $(document).on('click', 'a[href]:not([target="_blank"]):not(.cachekey)', function () {
                this.classList.add('cachekey');
                this.href = this.href.replace('.html', '.html?' + cachekey);
            });
        })();
	</script>
    </head>
<body class="typespace">
<a id="anchor" href="./" style="display: none"></a>
<h1 class="ellipsis fixed">
	<span class="pull-left">
	Structure
	<small class="ellipsis-text">(ryunosuke\Functions\Package\FileSystem)</small>
	</span>
	<span class="pull-right">
		<small class="frame-switch">
		<a target="_parent">frame</a> | <a target="_parent">noframe</a>
		</small>
	</span>
</h1>
<div class="main-wrapper">
	<div class="attribute">
		<span class="label label-danger"></span>
		<span class="label label-warning"></span>
		<span class="label label-info"></span>
		<span class="label label-info"></span>
		<span class="label label-deprecated"></span>
        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L5-L2053" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                    	</div>

	<h2>class <span class="category-name">ryunosuke\Functions\Package\FileSystem</span></h2>

	<div class="description"><p>ファイルシステム関連のユーティリティ</p>
</div>

	<h3>Construction</h3>
        	<table class="table">
		<caption>Implements</caption>
		<tbody>
        			<tr>
				<td class="type"><a href="ryunosuke-Functions-Package-Interfaces-FileSystem$typespace.html#ryunosuke\Functions\Package\Interfaces\FileSystem" class="fqsen "><small>ryunosuke\Functions\Package\Interfaces\</small><wbr>FileSystem</a></td>
				<td class="desc"></td>
			</tr>
        		</tbody>
	</table>
            
	<h3>Hierarchy</h3>
	<div class="hierarchy"></div>

	<h3>Constants</h3>
    
	<h3>Properties</h3>
    
	<h3>Methods</h3>
    		<ul>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L10-L184" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::file_matcher()" tabindex="-1" class="structure-title ">
                        file_matcher                        	<small>($filter_condition) : <a href="http://php.net/manual/ja/class.closure.php" class="fqsen" target="_blank">\Closure</a></small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>各種属性を指定してファイルのマッチングを行うクロージャを返す</p>
<p>※ 内部向け</p>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">array</td>
				<td class="rest">$filter_condition</td>
				<td class="desc"><p>マッチャーコンディション配列（ソースを参照）</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type"><a href="http://php.net/manual/ja/class.closure.php" class="fqsen" target="_blank">\Closure</a></td>
			<td class="desc"><p>ファイルマッチャー</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L186-L242" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::file_list()" tabindex="-1" class="structure-title ">
                        file_list                        	<small>($dirname, $filter_condition = []) : array<span class="type-separator"></span><wbr>false</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>ファイル一覧を配列で返す</p>
<p>Example:</p>
<pre><code class="language-php">// 適当にファイルを用意
$DS = DIRECTORY_SEPARATOR;
$tmp = sys_get_temp_dir() . "{$DS}file_list";
rm_rf($tmp, false);
file_set_contents("$tmp/a.txt", 'a');
file_set_contents("$tmp/dir/b.txt", 'b');
file_set_contents("$tmp/dir/dir/c.txt", 'c');
// ファイル一覧が取得できる
that(file_list($tmp))-&gt;equalsCanonicalizing([
    "$tmp{$DS}a.txt",
    "$tmp{$DS}dir{$DS}b.txt",
    "$tmp{$DS}dir{$DS}dir{$DS}c.txt",
]);
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$dirname</td>
				<td class="desc"><p>調べるディレクトリ名</p>
</td>
			</tr>
        			<tr>
				<td class="type">array</td>
				<td class="rest">$filter_condition = []</td>
				<td class="desc"><p>フィルタ条件</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">array<span class="type-separator"></span><wbr>false</td>
			<td class="desc"><p>ファイルの配列</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L244-L307" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::file_tree()" tabindex="-1" class="structure-title ">
                        file_tree                        	<small>($dirname, $filter_condition = []) : array<span class="type-separator"></span><wbr>false</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>ディレクトリ階層をツリー構造で返す</p>
<p>Example:</p>
<pre><code class="language-php">// 適当にファイルを用意
$DS = DIRECTORY_SEPARATOR;
$tmp = sys_get_temp_dir() . "{$DS}file_tree";
rm_rf($tmp, false);
file_set_contents("$tmp/a.txt", 'a');
file_set_contents("$tmp/dir/b.txt", 'b');
file_set_contents("$tmp/dir/dir/c.txt", 'c');
// ファイルツリーが取得できる
that(file_tree($tmp))-&gt;is([
    'file_tree' =&gt; [
        'a.txt' =&gt; "$tmp{$DS}a.txt",
        'dir'   =&gt; [
            'b.txt' =&gt; "$tmp{$DS}dir{$DS}b.txt",
            'dir'   =&gt; [
                'c.txt' =&gt; "$tmp{$DS}dir{$DS}dir{$DS}c.txt",
            ],
        ],
    ],
]);
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$dirname</td>
				<td class="desc"><p>調べるディレクトリ名</p>
</td>
			</tr>
        			<tr>
				<td class="type">array</td>
				<td class="rest">$filter_condition = []</td>
				<td class="desc"><p>フィルタ条件</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">array<span class="type-separator"></span><wbr>false</td>
			<td class="desc"><p>ツリー構造の配列</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L309-L342" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::file_suffix()" tabindex="-1" class="structure-title ">
                        file_suffix                        	<small>($filename, $suffix) : string</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>ファイル名にサフィックスを付与する</p>
<p>pathinfoに非準拠。例えば「filename.hoge.fuga」のような形式は「filename」が変換対象になる。</p>
<p>Example:</p>
<pre><code class="language-php">that(file_suffix('filename.ext', '-min'))-&gt;isSame('filename-min.ext');
that(file_suffix('filename.ext1.ext2', '-min'))-&gt;isSame('filename-min.ext1.ext2');
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$filename</td>
				<td class="desc"><p>パス・ファイル名</p>
</td>
			</tr>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$suffix</td>
				<td class="desc"><p>付与するサフィックス</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">string</td>
			<td class="desc"><p>サフィックスが付与されたパス名</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L344-L378" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::file_extension()" tabindex="-1" class="structure-title ">
                        file_extension                        	<small>($filename, $extension = &quot;&quot;) : string</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>ファイルの拡張子を変更する。引数を省略すると拡張子を返す</p>
<p>pathinfo に準拠。例えば「filename.hoge.fuga」のような形式は「fuga」が変換対象になる。</p>
<p>Example:</p>
<pre><code class="language-php">that(file_extension('filename.ext'))-&gt;isSame('ext');
that(file_extension('filename.ext', 'txt'))-&gt;isSame('filename.txt');
that(file_extension('filename.ext', ''))-&gt;isSame('filename');
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$filename</td>
				<td class="desc"><p>調べるファイル名</p>
</td>
			</tr>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$extension = &quot;&quot;</td>
				<td class="desc"><p>拡張子。nullや空文字なら拡張子削除</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">string</td>
			<td class="desc"><p>拡張子変換後のファイル名 or 拡張子</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L380-L462" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::file_get_arrays()" tabindex="-1" class="structure-title ">
                        file_get_arrays                        	<small>($filename, $options = []) : array</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>指定ファイルを拡張子別に php の配列として読み込む</p>
<p>形式は拡張子で自動判別する。<br />
その際、2重拡張子で hoge.sjis.csv のように指定するとそのファイルのエンコーディングを指定したことになる。</p>
<p>Example:</p>
<pre><code class="language-php">// csv ファイルを読み込んで配列で返す
file_put_contents($csvfile = sys_get_temp_dir() . '/hoge.csv', 'a,b,c
1,2,3
4,5,6
7,8,9
');
that(file_get_arrays($csvfile))-&gt;isSame([
    ['a' =&gt; '1', 'b' =&gt; '2', 'c' =&gt; '3'],
    ['a' =&gt; '4', 'b' =&gt; '5', 'c' =&gt; '6'],
    ['a' =&gt; '7', 'b' =&gt; '8', 'c' =&gt; '9'],
]);

// sjis の json ファイルを読み込んで配列で返す
file_put_contents($jsonfile = sys_get_temp_dir() . '/hoge.sjis.json', '[
{"a": 1, "b": 2, "c": 3},
{"a": 4, "b": 5, "c": 6},
{"a": 7, "b": 8, "c": 9}
]');
that(file_get_arrays($jsonfile))-&gt;isSame([
    ['a' =&gt; 1, 'b' =&gt; 2, 'c' =&gt; 3],
    ['a' =&gt; 4, 'b' =&gt; 5, 'c' =&gt; 6],
    ['a' =&gt; 7, 'b' =&gt; 8, 'c' =&gt; 9],
]);
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$filename</td>
				<td class="desc"><p>読み込むファイル名</p>
</td>
			</tr>
        			<tr>
				<td class="type">array</td>
				<td class="rest">$options = []</td>
				<td class="desc"><p>各種オプション</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">array</td>
			<td class="desc"><p>レコード配列</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L464-L509" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::file_set_contents()" tabindex="-1" class="structure-title ">
                        file_set_contents                        	<small>($filename, $data, $umask = 2) : int</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>ディレクトリも掘る file_put_contents</p>
<p>書き込みは一時ファイルと rename を使用してアトミックに行われる。</p>
<p>Example:</p>
<pre><code class="language-php">file_set_contents(sys_get_temp_dir() . '/not/filename.ext', 'hoge');
that(file_get_contents(sys_get_temp_dir() . '/not/filename.ext'))-&gt;isSame('hoge');
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$filename</td>
				<td class="desc"><p>書き込むファイル名</p>
</td>
			</tr>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$data</td>
				<td class="desc"><p>書き込む内容</p>
</td>
			</tr>
        			<tr>
				<td class="type">int</td>
				<td class="rest">$umask = 2</td>
				<td class="desc"><p>ディレクトリを掘る際の umask</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">int</td>
			<td class="desc"><p>書き込まれたバイト数</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L511-L570" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::file_rewrite_contents()" tabindex="-1" class="structure-title ">
                        file_rewrite_contents                        	<small>($filename, $callback, $operation = 0) : int</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>ファイルを読み込んで内容をコールバックに渡して書き込む</p>
<p>Example:</p>
<pre><code class="language-php">// 適当にファイルを用意
$testpath = sys_get_temp_dir() . '/rewrite.txt';
file_put_contents($testpath, 'hoge');
// 前後に 'pre-', '-fix' を付与する
file_rewrite_contents($testpath, fn($contents, $fp) =&gt; "pre-$contents-fix");
that($testpath)-&gt;fileEquals('pre-hoge-fix');
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$filename</td>
				<td class="desc"><p>読み書きするファイル名</p>
</td>
			</tr>
        			<tr>
				<td class="type">callable</td>
				<td class="rest">$callback</td>
				<td class="desc"><p>書き込む内容。引数で $contents, $fp が渡ってくる</p>
</td>
			</tr>
        			<tr>
				<td class="type">int</td>
				<td class="rest">$operation = 0</td>
				<td class="desc"><p>ロック定数（LOCL_SH, LOCK_EX, LOCK_NB）</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">int</td>
			<td class="desc"><p>書き込まれたバイト数</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L572-L625" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::file_set_tree()" tabindex="-1" class="structure-title ">
                        file_set_tree                        	<small>($root, $contents_tree, $umask = 2) : array</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>ツリー構造で file_set_contents する</p>
<p>値が配列の場合はディレクトリ、それ以外の場合はファイルとなる。<br />
値がクロージャーの場合はコールされる。<br />
返り値として書き込んだバイト数のフルパス配列を返す。</p>
<p>Example:</p>
<pre><code class="language-php">// 一時ディレクトリにツリー構造でファイルを配置する
$root = sys_get_temp_dir();
file_set_tree($root, [
    'hoge.txt' =&gt; 'HOGE',
    'dir1' =&gt; [
        'fuga.txt' =&gt; 'FUGA',
        'dir2'     =&gt; [
            'piyo.txt' =&gt; 'PIYO',
        ],
    ],
]);
that("$root/hoge.txt")-&gt;fileEquals('HOGE');
that("$root/dir1/fuga.txt")-&gt;fileEquals('FUGA');
that("$root/dir1/dir2/piyo.txt")-&gt;fileEquals('PIYO');
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$root</td>
				<td class="desc"><p>ルートパス</p>
</td>
			</tr>
        			<tr>
				<td class="type">array</td>
				<td class="rest">$contents_tree</td>
				<td class="desc"><p>コンテンツツリー</p>
</td>
			</tr>
        			<tr>
				<td class="type">int</td>
				<td class="rest">$umask = 2</td>
				<td class="desc"><p>umask</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">array</td>
			<td class="desc"><p>書き込まれたバイト数配列</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L627-L701" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::file_equals()" tabindex="-1" class="structure-title ">
                        file_equals                        	<small>($file1, $file2, $chunk_size = null) : bool</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>ファイルが同じ内容か返す</p>
<p>ファイルサイズで比較して一致したら更に内容を読んで判定する。<br />
ディレクトリ同士の場合は直下のファイル群を内容とみなして判定する。</p>
<p>Example:</p>
<pre><code class="language-php">// 適当にファイルを用意
$testpath1 = sys_get_temp_dir() . '/file_equals1.txt';
$testpath2 = sys_get_temp_dir() . '/file_equals2.txt';
$testpath3 = sys_get_temp_dir() . '/file_equals3.txt';
file_put_contents($testpath1, "hoge");
file_put_contents($testpath2, "foo");
file_put_contents($testpath3, "hoge");
// 異なるなら false
that(file_equals($testpath1, $testpath2))-&gt;isFalse();
// 同じなら true
that(file_equals($testpath1, $testpath3))-&gt;isTrue();
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$file1</td>
				<td class="desc"><p>ファイル名1</p>
</td>
			</tr>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$file2</td>
				<td class="desc"><p>ファイル名2</p>
</td>
			</tr>
        			<tr>
				<td class="type">?int</td>
				<td class="rest">$chunk_size = null</td>
				<td class="desc"><p>読み込みチャンクサイズ</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">bool</td>
			<td class="desc"><p>ファイルが同じ内容なら true</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L703-L780" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::file_pos()" tabindex="-1" class="structure-title ">
                        file_pos                        	<small>($filename, $needle, $start = 0, $end = null, $chunksize = null) : int<span class="type-separator"></span><wbr>false</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>範囲指定でファイルを読んで位置を返す</p>
<p>$needle に配列を与えると OR 的動作で一つでも見つかった時点の位置を返す。<br />
このとき「どれが見つかったか？」は得られない（場合によっては不便なので将来の改修対象）。</p>
<p>Example:</p>
<pre><code class="language-php">// 適当にファイルを用意
$testpath = sys_get_temp_dir() . '/file_pos.txt';
file_put_contents($testpath, "hoge\nfuga\npiyo\nfuga");
// fuga の位置を返す
that(file_pos($testpath, 'fuga'))-&gt;is(5);
// 2つ目の fuga の位置を返す
that(file_pos($testpath, 'fuga', 6))-&gt;is(15);
// 見つからない場合は false を返す
that(file_pos($testpath, 'hogera'))-&gt;is(false);
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$filename</td>
				<td class="desc"><p>ファイル名</p>
</td>
			</tr>
        			<tr>
				<td class="type">string<span class="type-separator"></span><wbr>array</td>
				<td class="rest">$needle</td>
				<td class="desc"><p>探す文字列</p>
</td>
			</tr>
        			<tr>
				<td class="type">int</td>
				<td class="rest">$start = 0</td>
				<td class="desc"><p>読み込み位置</p>
</td>
			</tr>
        			<tr>
				<td class="type">int<span class="type-separator"></span><wbr>null</td>
				<td class="rest">$end = null</td>
				<td class="desc"><p>読み込むまでの位置。省略時は指定なし（最後まで）。負数は後ろからのインデックス</p>
</td>
			</tr>
        			<tr>
				<td class="type">int<span class="type-separator"></span><wbr>null</td>
				<td class="rest">$chunksize = null</td>
				<td class="desc"><p>読み込みチャンクサイズ。省略時は 4096 の倍数に正規化</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">int<span class="type-separator"></span><wbr>false</td>
			<td class="desc"><p>$needle の位置。見つからなかった場合は false</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L782-L884" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::file_slice()" tabindex="-1" class="structure-title ">
                        file_slice                        	<small>($filename, $start_line = 1, $length = null, $flags = 0, $context = null) : array</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>file の行範囲を指定できる板</p>
<p>原則 file をベースに作成しているが、一部独自仕様がある。</p>
<ul>
<li>結果配列は行番号がキーになる<ul>
<li>あくまで行番号なので 1 オリジン</li>
<li>スキップされた行は歯抜けになる</li>
</ul>
</li>
<li>FILE_SKIP_EMPTY_LINES の動作が FILE_IGNORE_NEW_LINES ありきではない<ul>
<li>file における FILE_SKIP_EMPTY_LINES の単独指定は意味を成さないっぽい<ul>
<li>FILE_IGNORE_NEW_LINES しないと空文字ではなく改行文字が含まれるので空判定にならないようだ</li>
</ul>
</li>
<li>この関数はその動作を撤廃しており、単独で FILE_SKIP_EMPTY_LINES を指定しても空行が飛ばされる動作になっている</li>
</ul>
</li>
<li>$end_line に負数を指定すると行番号の直指定となる<ul>
<li><code>file_slice($filename, 120, -150)</code> で 120行目から150行目までを読む</li>
<li>負数なのは気持ち悪いが、範囲指定のハイフン（120-150）だと思えば割と自然</li>
</ul>
</li>
</ul>
<p>使用用途としては</p>
<ol>
<li>巨大ファイルの前半だけ読みたい</li>
<li>1行だけサクッと読みたい</li>
</ol>
<p>が挙げられる。</p>
<p>1 は自明（file は全行読む）だが、終端付近を読む場合は file の方が若干速い。<br />
ただし、期待値としてはこの関数の方が格段に低い（file は下手すると何十倍も遅い）。</p>
<p>2 は典型的には「1行目だけ読みたい」場合、fopen+fgets+fclose(finally)という手順を踏む必要があり煩雑になる。<br />
この関数を使えばサクッと取得することができる。</p>
<p>Example:</p>
<pre><code class="language-php">// 適当にファイルを用意（奇数行は行番号、偶数行は空行）
$testpath = sys_get_temp_dir() . '/file_slice.txt';
file_put_contents($testpath, implode("\n", array_map(fn($n) =&gt; $n % 2 ? $n : "", range(1, 20))));
// 3行目から4行を返す
that(file_slice($testpath, 3, 4))-&gt;is([
    3 =&gt; "3\n",
    4 =&gt; "\n",
    5 =&gt; "5\n",
    6 =&gt; "\n",
]);
// 3行目から6行目までを返す
that(file_slice($testpath, 3, -6))-&gt;is([
    3 =&gt; "3\n",
    4 =&gt; "\n",
    5 =&gt; "5\n",
    6 =&gt; "\n",
]);
// 改行文字や空行を含めない（キーは保持される）
that(file_slice($testpath, 3, 4, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES))-&gt;is([
    3 =&gt; "3",
    5 =&gt; "5",
]);
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$filename</td>
				<td class="desc"><p>ファイル名</p>
</td>
			</tr>
        			<tr>
				<td class="type">int</td>
				<td class="rest">$start_line = 1</td>
				<td class="desc"><p>開始行。1 オリジン</p>
</td>
			</tr>
        			<tr>
				<td class="type">?int</td>
				<td class="rest">$length = null</td>
				<td class="desc"><p>終了行。null を指定すると最後まで読む。負数にすると行番号直指定になる</p>
</td>
			</tr>
        			<tr>
				<td class="type">int</td>
				<td class="rest">$flags = 0</td>
				<td class="desc"><p>file と同じフラグ定数（FILE_IGNORE_NEW_LINES, etc）</p>
</td>
			</tr>
        			<tr>
				<td class="type">?resource</td>
				<td class="rest">$context = null</td>
				<td class="desc"><p>file と同じ context 指定</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">array</td>
			<td class="desc"><p>部分行</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L886-L921" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::file_mimetype()" tabindex="-1" class="structure-title ">
                        file_mimetype                        	<small>($filename) : string<span class="type-separator"></span><wbr>null</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>ファイルの mimetype を返す</p>
<p>mime_content_type の http 対応版。<br />
変更点は下記。</p>
<ul>
<li>http(s) に対応（HEAD メソッドで取得する）</li>
<li>失敗時に false ではなく null を返す</li>
</ul>
<p>Example:</p>
<pre><code class="language-php">that(file_mimetype(__FILE__))-&gt;is('text/x-php');
that(file_mimetype('http://httpbin.org/get?name=value'))-&gt;is('application/json');
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$filename</td>
				<td class="desc"><p>ファイル名（URL）</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">string<span class="type-separator"></span><wbr>null</td>
			<td class="desc"><p>MIME タイプ</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L923-L943" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::mkdir_p()" tabindex="-1" class="structure-title ">
                        mkdir_p                        	<small>($dirname, $umask = 2) : bool</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>ディレクトリを再帰的に掘る</p>
<p>既に存在する場合は何もしない（エラーも出さない）。</p>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$dirname</td>
				<td class="desc"><p>ディレクトリ名</p>
</td>
			</tr>
        			<tr>
				<td class="type">int</td>
				<td class="rest">$umask = 2</td>
				<td class="desc"><p>ディレクトリを掘る際の umask</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">bool</td>
			<td class="desc"><p>作成したら true</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L945-L976" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::dirname_r()" tabindex="-1" class="structure-title ">
                        dirname_r                        	<small>($path, $callback) : mixed</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>コールバックが true 相当を返すまで親ディレクトリを辿り続ける</p>
<p>コールバックには親ディレクトリが引数として渡ってくる。</p>
<p>Example:</p>
<pre><code class="language-php">// //tmp/a/b/file.txt を作っておく
$tmp = sys_get_temp_dir();
file_set_contents("$tmp/a/b/file.txt", 'hoge');
// /a/b/c/d/e/f から開始して「どこかの階層の file.txt を探したい」という状況を想定
$callback = fn($path) =&gt; realpath("$path/file.txt");
that(dirname_r("$tmp/a/b/c/d/e/f", $callback))-&gt;isSame(realpath("$tmp/a/b/file.txt"));
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$path</td>
				<td class="desc"><p>パス名</p>
</td>
			</tr>
        			<tr>
				<td class="type">callable</td>
				<td class="rest">$callback</td>
				<td class="desc"><p>コールバック</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">mixed</td>
			<td class="desc"><p>$callback の返り値。頂上まで辿ったら false</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L978-L1023" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::dirmtime()" tabindex="-1" class="structure-title ">
                        dirmtime                        	<small>($dirname, $recursive = true) : int</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>ディレクトリの最終更新日時を返す</p>
<p>「ディレクトリの最終更新日時」とは filemtime で得られる結果ではなく、「配下のファイル群で最も新しい日時」を表す。<br />
ディレクトリの mtime も検出に含まれるので、ファイルを削除した場合も検知できる。</p>
<p>ファイル名を与えると例外を投げる。<br />
空ディレクトリの場合は自身の mtime を返す。</p>
<p>Example:</p>
<pre><code class="language-php">$dirname = sys_get_temp_dir() . '/mtime';
rm_rf($dirname);
mkdir($dirname);

// この時点では現在日時（単純に自身の更新日時）
that(dirmtime($dirname))-&gt;isBetween(time() - 2, time());
// ファイルを作って更新するとその時刻
touch("$dirname/tmp", time() + 10);
that(dirmtime($dirname))-&gt;isSame(time() + 10);
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$dirname</td>
				<td class="desc"><p>ディレクトリ名</p>
</td>
			</tr>
        			<tr>
				<td class="type">bool</td>
				<td class="rest">$recursive = true</td>
				<td class="desc"><p>再帰フラグ</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">int</td>
			<td class="desc"><p>最終更新日時</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L1025-L1095" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::dir_diff()" tabindex="-1" class="structure-title ">
                        dir_diff                        	<small>($path1, $path2, $options = []) : array</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>ファイルツリーを比較して配列で返す</p>
<p>ファイル名をキーとし、</p>
<ul>
<li>$path1 にしかないファイルは false</li>
<li>$path2 にしかないファイルは true</li>
<li>両方にあり、内容が異なる場合はなんらかの文字列（comparator オプション）</li>
<li>両方にあり、内容が同じ場合は結果に含まれない</li>
</ul>
<p>comparator オプションは両方に存在した場合にコールされるので差分を返したり更新日時を返したリできる。<br />
comparator が null を返した場合、その要素は内容が同じとみなされ、結果配列に含まれなくなる。</p>
<p>Example:</p>
<pre><code class="language-php">// すべてにマッチするので true
that(fnmatch_and(['*aaa*', '*bbb*'], 'aaaXbbbX'))-&gt;isTrue();
// aaa にはマッチするが bbb にはマッチしないので false
that(fnmatch_and(['*aaa*', '*bbb*'], 'aaaX'))-&gt;isFalse();
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$path1</td>
				<td class="desc"><p>パス1</p>
</td>
			</tr>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$path2</td>
				<td class="desc"><p>パス2</p>
</td>
			</tr>
        			<tr>
				<td class="type">array</td>
				<td class="rest">$options = []</td>
				<td class="desc"><p>オプション</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">array</td>
			<td class="desc"><p>比較配列</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L1097-L1129" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::fnmatch_and()" tabindex="-1" class="structure-title ">
                        fnmatch_and                        	<small>($patterns, $string, $flags = 0) : bool</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>fnmatch の AND 版</p>
<p>$patterns のうちどれか一つでもマッチしなかったら false を返す。<br />
$patterns が空だと例外を投げる。</p>
<p>Example:</p>
<pre><code class="language-php">// すべてにマッチするので true
that(fnmatch_and(['*aaa*', '*bbb*'], 'aaaXbbbX'))-&gt;isTrue();
// aaa にはマッチするが bbb にはマッチしないので false
that(fnmatch_and(['*aaa*', '*bbb*'], 'aaaX'))-&gt;isFalse();
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">array<span class="type-separator"></span><wbr>string</td>
				<td class="rest">$patterns</td>
				<td class="desc"><p>パターン配列（単一文字列可）</p>
</td>
			</tr>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$string</td>
				<td class="desc"><p>調べる文字列</p>
</td>
			</tr>
        			<tr>
				<td class="type">int</td>
				<td class="rest">$flags = 0</td>
				<td class="desc"><p>FNM_***</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">bool</td>
			<td class="desc"><p>すべてにマッチしたら true</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L1131-L1163" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::fnmatch_or()" tabindex="-1" class="structure-title ">
                        fnmatch_or                        	<small>($patterns, $string, $flags = 0) : bool</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>fnmatch の OR 版</p>
<p>$patterns のうちどれか一つでもマッチしたら true を返す。<br />
$patterns が空だと例外を投げる。</p>
<p>Example:</p>
<pre><code class="language-php">// aaa にマッチするので true
that(fnmatch_or(['*aaa*', '*bbb*'], 'aaaX'))-&gt;isTrue();
// どれともマッチしないので false
that(fnmatch_or(['*aaa*', '*bbb*'], 'cccX'))-&gt;isFalse();
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">array<span class="type-separator"></span><wbr>string</td>
				<td class="rest">$patterns</td>
				<td class="desc"><p>パターン配列（単一文字列可）</p>
</td>
			</tr>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$string</td>
				<td class="desc"><p>調べる文字列</p>
</td>
			</tr>
        			<tr>
				<td class="type">int</td>
				<td class="rest">$flags = 0</td>
				<td class="desc"><p>FNM_***</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">bool</td>
			<td class="desc"><p>どれかにマッチしたら true</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L1165-L1204" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::path_is_absolute()" tabindex="-1" class="structure-title ">
                        path_is_absolute                        	<small>($path) : bool</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>パスが絶対パスか判定する</p>
<p>Example:</p>
<pre><code class="language-php">that(path_is_absolute('/absolute/path'))-&gt;isTrue();
that(path_is_absolute('relative/path'))-&gt;isFalse();
// Windows 環境では下記も true になる
if (DIRECTORY_SEPARATOR === '\\') {
    that(path_is_absolute('\\absolute\\path'))-&gt;isTrue();
    that(path_is_absolute('C:\\absolute\\path'))-&gt;isTrue();
}
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$path</td>
				<td class="desc"><p>パス文字列</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">bool</td>
			<td class="desc"><p>絶対パスなら true</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L1206-L1261" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::path_resolve()" tabindex="-1" class="structure-title ">
                        path_resolve                        	<small>(...$paths) : ?string</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>パスを絶対パスに変換して正規化する</p>
<p>可変引数で与えられた文字列群を結合して絶対パス化して返す。<br />
出来上がったパスが絶対パスでない場合は PATH 環境変数を使用して解決を試みる。</p>
<p>歴史的な理由により最後の引数を配列にするとその候補と PATH からの解決を試みる。<br />
解決できなかった場合 null を返す。<br />
配列を指定しなかった場合はカレントディレクトリを結合して返す。</p>
<p>Example:</p>
<pre><code class="language-php">$DS = DIRECTORY_SEPARATOR;
that(path_resolve('/absolute/path'))-&gt;isSame("{$DS}absolute{$DS}path");
that(path_resolve('absolute/path'))-&gt;isSame(getcwd() . "{$DS}absolute{$DS}path");
that(path_resolve('/absolute/path/through', '../current/./path'))-&gt;isSame("{$DS}absolute{$DS}path{$DS}current{$DS}path");

# 最後の引数に配列を与えるとそのパスと PATH から解決を試みる（要するに which 的な動作になる）
if ($DS === '/') {
    that(path_resolve('php', []))-&gt;isSame(PHP_BINARY);
}
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string<span class="type-separator"></span><wbr>array</td>
				<td class="rest">...$paths</td>
				<td class="desc"><p>パス文字列（可変引数）</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">?string</td>
			<td class="desc"><p>絶対パス</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L1263-L1292" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::path_relative()" tabindex="-1" class="structure-title ">
                        path_relative                        	<small>($from, $to) : string</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>パスを相対パスに変換して正規化する</p>
<p>$from から $to への相対パスを返す。</p>
<p>Example:</p>
<pre><code class="language-php">$DS = DIRECTORY_SEPARATOR;
that(path_relative('/a/b/c/X', '/a/b/c/d/X'))-&gt;isSame("..{$DS}d{$DS}X");
that(path_relative('/a/b/c/d/X', '/a/b/c/X'))-&gt;isSame("..{$DS}..{$DS}X");
that(path_relative('/a/b/c/X', '/a/b/c/X'))-&gt;isSame("");
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$from</td>
				<td class="desc"><p>元パス</p>
</td>
			</tr>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$to</td>
				<td class="desc"><p>対象パス</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">string</td>
			<td class="desc"><p>相対パス</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L1294-L1354" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::path_normalize()" tabindex="-1" class="structure-title ">
                        path_normalize                        	<small>($path) : string</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>パスを正規化する</p>
<p>具体的には ./ や ../ を取り除いたり連続したディレクトリ区切りをまとめたりする。<br />
realpath ではない。のでシンボリックリンクの解決などはしない。その代わりファイルが存在しなくても使用することができる。</p>
<p>Example:</p>
<pre><code class="language-php">$DS = DIRECTORY_SEPARATOR;
that(path_normalize('/path/to/something'))-&gt;isSame("{$DS}path{$DS}to{$DS}something");
that(path_normalize('/path/through/../something'))-&gt;isSame("{$DS}path{$DS}something");
that(path_normalize('./path/current/./through/../something'))-&gt;isSame("path{$DS}current{$DS}something");
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$path</td>
				<td class="desc"><p>パス文字列</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">string</td>
			<td class="desc"><p>正規化されたパス</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L1356-L1417" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::path_parse()" tabindex="-1" class="structure-title ">
                        path_parse                        	<small>($path) : array</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>パスをパースする</p>
<p>pathinfo の（ほぼ）上位互換で下記の差異がある。</p>
<ul>
<li>パスは正規化される</li>
<li>$flags 引数はない（指定した各部だけを返すことはできない）</li>
<li>要素が未設定になることはない（例えば extension は拡張子がなくても明示的に null が入る）</li>
</ul>
<p>更に独自で下記のキーを返す。</p>
<ul>
<li>dirlocalname: 親ディレクトリと localname の結合（≒フルパスから複数拡張子を除いたもの）</li>
<li>localname: 複数拡張子を除いた filename</li>
<li>extensions: 複数拡張子を配列で返す（拡張子がない場合は空配列）</li>
</ul>
<p>Example:</p>
<pre><code class="language-php">$DS = DIRECTORY_SEPARATOR;
that(path_parse('/path/to/file.min.css'))-&gt;isSame([
    'dirname'      =&gt; "{$DS}path{$DS}to",
    'basename'     =&gt; "file.min.css",
    'filename'     =&gt; "file.min",
    'extension'    =&gt; "css",
    // ここまでは（正規化はされるが） pathinfo と同じ
    // ここからは独自のキー
    'dirlocalname' =&gt; "{$DS}path{$DS}to{$DS}file",
    'localname'    =&gt; "file",
    'extensions'   =&gt; ["min", "css"],
]);
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$path</td>
				<td class="desc"><p>パス文字列</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">array</td>
			<td class="desc"><p>パスパーツ</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L1419-L1486" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::cp_rf()" tabindex="-1" class="structure-title ">
                        cp_rf                        	<small>($src, $dst) : bool</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>ディレクトリのコピー</p>
<p>$dst に / を付けると「$dst に自身をコピー」する。付けないと「$dst に中身をコピー」するという動作になる。</p>
<p>ディレクトリではなくファイルを与えても動作する（copy とほぼ同じ動作になるが、対象にディレクトリを指定できる点が異なる）。</p>
<p>Example:</p>
<pre><code class="language-php">// /tmp/src/hoge.txt, /tmp/src/dir/fuga.txt を作っておく
$tmp = sys_get_temp_dir();
file_set_contents("$tmp/src/hoge.txt", 'hoge');
file_set_contents("$tmp/src/dir/fuga.txt", 'fuga');

// "/" を付けないと中身コピー
cp_rf("$tmp/src", "$tmp/dst1");
that("$tmp/dst1/hoge.txt")-&gt;fileEquals('hoge');
that("$tmp/dst1/dir/fuga.txt")-&gt;fileEquals('fuga');
// "/" を付けると自身コピー
cp_rf("$tmp/src", "$tmp/dst2/");
that("$tmp/dst2/src/hoge.txt")-&gt;fileEquals('hoge');
that("$tmp/dst2/src/dir/fuga.txt")-&gt;fileEquals('fuga');

// $src はファイルでもいい（$dst に "/" を付けるとそのディレクトリにコピーする）
cp_rf("$tmp/src/hoge.txt", "$tmp/dst3/");
that("$tmp/dst3/hoge.txt")-&gt;fileEquals('hoge');
// $dst に "/" を付けないとそのパスとしてコピー（copy と完全に同じ）
cp_rf("$tmp/src/hoge.txt", "$tmp/dst4");
that("$tmp/dst4")-&gt;fileEquals('hoge');
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$src</td>
				<td class="desc"><p>コピー元パス</p>
</td>
			</tr>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$dst</td>
				<td class="desc"><p>コピー先パス。末尾/でディレクトリであることを明示できる</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">bool</td>
			<td class="desc"><p>成功した場合に TRUE を、失敗した場合に FALSE を返します</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L1488-L1530" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::rm_rf()" tabindex="-1" class="structure-title ">
                        rm_rf                        	<small>($dirname, $self = true) : bool</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>中身があっても消せる rmdir</p>
<p>Example:</p>
<pre><code class="language-php">mkdir(sys_get_temp_dir() . '/new/make/dir', 0777, true);
rm_rf(sys_get_temp_dir() . '/new');
that(file_exists(sys_get_temp_dir() . '/new'))-&gt;isSame(false);
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$dirname</td>
				<td class="desc"><p>削除するディレクトリ名。glob パターンが使える</p>
</td>
			</tr>
        			<tr>
				<td class="type">bool</td>
				<td class="rest">$self = true</td>
				<td class="desc"><p>自分自身も含めるか。false を与えると中身だけを消す</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">bool</td>
			<td class="desc"><p>成功した場合に TRUE を、失敗した場合に FALSE を返します</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L1532-L1576" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::tmpname()" tabindex="-1" class="structure-title ">
                        tmpname                        	<small>($prefix = &quot;rft&quot;, $dir = null) : string</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>終了時に削除される一時ファイル名を生成する</p>
<p>tempnam とほぼ同じで違いは下記。</p>
<ul>
<li>引数が逆</li>
<li>終了時に削除される</li>
<li>失敗時に false を返すのではなく例外を投げる</li>
</ul>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$prefix = &quot;rft&quot;</td>
				<td class="desc"><p>ファイル名プレフィックス</p>
</td>
			</tr>
        			<tr>
				<td class="type">?string</td>
				<td class="rest">$dir = null</td>
				<td class="desc"><p>生成ディレクトリ。省略時は sys_get_temp_dir()</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">string</td>
			<td class="desc"><p>一時ファイル名</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L1578-L1633" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::get_modified_files()" tabindex="-1" class="structure-title ">
                        get_modified_files                        	<small>($target_pattern = &quot;*.php&quot;, $ignore_pattern = &quot;*.phtml&quot;) : array</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>初回読み込み時から変更のあったファイル配列を返す</p>
<p>初回呼び出し時は必ず空配列を返し、以後の呼び出しで変更のあったファイルを返す。<br />
削除されたファイルも変更とみなす。</p>
<p>用途的には「php で書かれたデーモンで、変更感知して自動で再起動する（systemd に任せる）」がある。</p>
<p>Example:</p>
<pre><code class="language-php">// 別プロセスで3秒後に自分自身を触る
$p = process_async(PHP_BINARY, ['-r' =&gt; 'sleep(3);touch($argv[1]);', __FILE__]);

$time = microtime(true);
foreach (range(1, 10) as $i) {
    // 何らかのデーモン（完全に wait する系ではなく時々処理が戻ってくる必要がある）
    sleep(1);

    // 自身の変更を感知したら break なり exit なりで抜ける（大抵はそのまま終了する。起動は systemd に丸投げする）
    if (get_modified_files(__FILE__)) {
        break;
    }
}
// 全ループすると10秒かかるが、大体3秒程度で抜けているはず
that(microtime(true) - $time)-&gt;lt(3.9);
unset($p);
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string<span class="type-separator"></span><wbr>array</td>
				<td class="rest">$target_pattern = &quot;*.php&quot;</td>
				<td class="desc"><p>対象ファイルパターン（マッチしないものは無視される）</p>
</td>
			</tr>
        			<tr>
				<td class="type">string<span class="type-separator"></span><wbr>array</td>
				<td class="rest">$ignore_pattern = &quot;*.phtml&quot;</td>
				<td class="desc"><p>除外ファイルパターン（マッチしたものは無視される）</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">array</td>
			<td class="desc"><p>変更のあったファイル名配列</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            				<li class="structure-item">
					<div class="attribute">
						<span class="label label-danger"></span>
						<span class="label label-default">static</span>
						<span class="label label-magic"></span>
						<span class="label label-danger"></span>
						<span class="label label-default"></span>
						<span class="label label-default"></span>
						<span class="label label-deprecated"></span>
						<span class="label label-public">public</span>
                        			<a href="https://github.com/arima-ryunosuke/php-functions/blob/master/src/Package/FileSystem.php#L1635-L2052" class="source-link glyphicon glyphicon-new-window" target="_blank"></a>
                                    					</div>
					<h4 id="ryunosuke\Functions\Package\FileSystem::memory_path()" tabindex="-1" class="structure-title ">
                        memory_path                        	<small>($path = &quot;&quot;) : string</small>
						</h4>
					<div class="inner-item">
						<div class="description"><p>ファイルのように扱えるメモリ上のパスを返す</p>
<p>劣化 vfsStream のようなもの。<br />
stream wrapper を用いて実装しており、そのプロトコルは初回呼び出し時に1度だけ登録される。<br />
プロトコル名は決め打ちだが、 php.ini に "rfunc.memory_stream" というキーで文字列を指定するとそれが使用される。</p>
<p>Example:</p>
<pre><code class="language-php">// ファイル名のように読み書きができるパスを返す（一時ファイルを使用するよりかなり高速に動作する）
$memory_path = memory_path('filename.txt');
// 呼んだだけでは何もしないので存在しない
that(file_exists($memory_path))-&gt;isSame(false);
// file_put_contents が使える
that(file_put_contents($memory_path, 'Hello, World'))-&gt;isSame(12);
// file_get_contents が使える
that(file_get_contents($memory_path))-&gt;isSame('Hello, World');
// 上記の操作で実体が存在している
that(file_exists($memory_path))-&gt;isSame(true);
// unlink が使える
that(unlink($memory_path))-&gt;isSame(true);
// unlink したので存在しない
that(file_exists($memory_path))-&gt;isSame(false);
</code></pre>
</div>
                        	<table class="table">
		<caption>Parameters</caption>
		<tbody>
        			<tr>
				<td class="type">string</td>
				<td class="rest">$path = &quot;&quot;</td>
				<td class="desc"><p>パス名（実質的に一意なファイル名）</p>
</td>
			</tr>
        		</tbody>
	</table>
                            	<table class="table">
		<caption>Return</caption>
		<tbody>
		<tr>
			<td class="type">string</td>
			<td class="desc"><p>メモリ上のパス</p>
</td>
			<td class="rest"></td>
		</tr>
		</tbody>
	</table>
                                                                            					</div>
					<div class="attribute">
						<span class="label label-default"></span>
						<span class="label label-default"></span>
					</div>
					<div class="clearfix"></div>
				</li>
            		</ul>
    
	<div class="attribute">
		<span class="label label-default"></span>
		<span class="label label-default"></span>
	</div>
	<div class="clearfix"></div>
</div>
</body>
</html>
